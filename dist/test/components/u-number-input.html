<!DOCTYPE html>
<!--[if IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 ie6" lang="zh-CN"><![endif]-->
<!--[if IE 7]><html class="lt-ie9 lt-ie8 ie7" lang="zh-CN"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 ie8" lang="zh-CN"><![endif]-->
<!--[if gte IE 9]><!--><html lang="zh-CN"><!--<![endif]-->
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="google" value="notranslate" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="robots" content="index,follow" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,shrink-to-fit=no,viewport-fit=cover"
    />
    <meta
      name="format-detection"
      content="telephone=no,email=no,address=no,date=no"
    />
    <meta name="msapplication-tap-highlight" content="no" />
    <!--[if lt IE 9]>
      <script src="/assets/vendors/html5shiv/3.7.3/dist/html5shiv.min.js"></script>
    <![endif]-->
    <title>number input</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <link
      href="../../assets/styles/main.css"
      rel="stylesheet"
    />
    <style type="text/css">
      .u-number-input {
        display: inline-block;
        *display: inline;
        *zoom: 1;
      }

      .u-number-input__input {
        display: block;
      }

      .u-number-input_inited {
        position: relative;
        padding: 0 2em;
      }

      .u-number-input_inited .u-number-input__input {
        -moz-appearance: textfield;
        display: block;
        width: 100%;
        text-align: center;
      }

      .u-number-input_inited .u-number-input__input::-webkit-inner-spin-button {
        -webkit-appearance: none;
      }

      .u-number-input__button {
        position: absolute;
        top: 0;
        width: 1.5em;
        -webkit-box-sizing: content-box;
        -moz-box-sizing: content-box;
        box-sizing: content-box;
      }

      .u-number-input__button_decrease {
        left: 0;
      }

      .u-number-input__button_increase {
        right: 0;
      }

      .demo {
        padding: 15px;
      }
    </style>
  </head>
  <body>
    <div class="container demo">
      <legend>.u-number-input (css„ÄÅjs)</legend>
      <label class="u-number-input">
        <input
          class="u-number-input__input"
          type="number"
          min="1"
          max="10"
          step="1"
          pattern="\d*"
        />
      </label>
    </div>

    <script src="../../project/scripts/config.js"></script>
    <!--[if IE 6]>
      <script src="/assets/vendors/dd_belatedpng/1.0.2/dist/DD_belatedPNG_1.0.2.min.js"></script>
      <script>
        DD_belatedPNG.fix('*')
      </script>
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="../../assets/vendors/jquery/1.12.4/dist/jquery.min.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
    <script src="../../assets/vendors/jquery/2.2.4/dist/jquery.min.js"></script>
    <!--<![endif]-->
    <script>
      /* eslint-disable strict */
      /* global $: true */
      var NUMBER_INPUT_SELECTOR = '.u-number-input'

      function initNumberInput() {
        var container = $(this)
        if (container.hasClass('.u-number-input_inited')) {
          return
        }

        container.addClass('u-number-input_inited')

        var input = $('input', container[0])
        var btnDecrease = $(
          '<button class="u-number-input__button u-number-input__button_decrease" type="button">-</button>'
        ).appendTo(container)
        var btnIncrease = $(
          '<button class="u-number-input__button u-number-input__button_increase" type="button">+</button>'
        ).appendTo(container)

        function getFloatProperty(prop, defalutValue) {
          var value = parseFloat(input.attr(prop))
          return isFinite(value) ? value : defalutValue
        }

        var min = getFloatProperty('min', -Infinity)
        var max = getFloatProperty('max', Infinity)
        var step = getFloatProperty('step', 1)
        var isMuted = input.prop('disabled') || input.prop('readonly')

        function increaseValue(valueIncrese, noTrigger) {
          valueIncrese = valueIncrese || 0
          var textValue = input.val()
          var currentValue = parseFloat(textValue)

          if (isNaN(currentValue)) {
            currentValue = ''
          } else {
            currentValue += valueIncrese

            if (currentValue % step) {
              currentValue = Math.floor(currentValue / step) * step
            }

            if (currentValue < min) {
              currentValue = min
            }
            if (currentValue > max) {
              currentValue = max
            }
          }

          var changed = String(currentValue) !== textValue

          if (changed) {
            input.val(currentValue)
          }

          setButton(currentValue)
          return changed
        }

        function setButton(currentValue) {
          btnDecrease.prop('disabled', isMuted || currentValue <= min)
          btnIncrease.prop('disabled', isMuted || currentValue >= max)
        }

        btnDecrease.on('click', function() {
          if (increaseValue(-step)) {
            input.trigger('change')
          }
        })

        btnIncrease.on('click', function() {
          if (increaseValue(step)) {
            input.trigger('change')
          }
        })

        input
          .on('change', function() {
            increaseValue()
          })
          .trigger('change')
      }

      $(function() {
        $(NUMBER_INPUT_SELECTOR).each(initNumberInput)
      })
    </script>
  </body>
</html>
